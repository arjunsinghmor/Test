import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class FileUploadServlet extends HttpServlet {
  
  private static final long serialVersionUID = 1L;
  
  protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    
    // Set the response content type
    response.setContentType("text/html");
    
    // Get the file upload input field
    Part filePart = request.getPart("file");
    
    // Get the file name
    String fileName = getFileName(filePart);
    
    // Get the file content type
    String contentType = filePart.getContentType();
    
    // Get the file size
    long fileSize = filePart.getSize();
    
    // Set the file upload directory
    String uploadPath = getServletContext().getRealPath("") + File.separator + "uploads";
    
    // Create the upload directory if it doesn't exist
    File uploadDir = new File(uploadPath);
    if (!uploadDir.exists()) {
      uploadDir.mkdir();
    }
    
    // Write the file to the upload directory
    String filePath = uploadPath + File.separator + fileName;
    filePart.write(filePath);
    
    // Display the file upload information
    PrintWriter out = response.getWriter();
    out.println("<html>");
    out.println("<head>");
    out.println("<title>File Upload Result</title>");
    out.println("</head>");
    out.println("<body>");
    out.println("<h2>File Upload Result</h2>");
    out.println("<p>File Name: " + fileName + "</p>");
    out.println("<p>Content Type: " + contentType + "</p>");
    out.println("<p>File Size: " + fileSize + " bytes</p>");
    out.println("<p>File Path: " + filePath + "</p>");
    out.println("</body>");
    out.println("</html>");
  }
  
  private String getFileName(final Part part) {
    final String partHeader = part.getHeader("content-disposition");
    for (String content : partHeader.split(";")) {
      if (content.trim().startsWith("filename")) {
        return content.substring(content.indexOf('=') + 1).trim().replace("\"", "");
      }
    }
    return null;
  }
}
